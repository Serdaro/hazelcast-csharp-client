<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>D:\a\hazelcast-csharp-client\hazelcast-csharp-client\src\Hazelcast.Net\Serialization\ObjectDataOutput.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
// Copyright (c) 2008-2021, Hazelcast, Inc. All Rights Reserved.
//
// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

using System;
using Hazelcast.Core;

namespace Hazelcast.Serialization
{
    internal partial class ObjectDataOutput : IObjectDataOutput, IDisposable
    {
        private readonly int _initialBufferSize;
        private readonly SerializationService _serializationService;
        private byte[] _buffer;
        private int _position;

        internal ObjectDataOutput(int initialBufferSize, SerializationService serializationService, Endianness endianness)
        {
            _initialBufferSize = initialBufferSize;
            _buffer = new byte[_initialBufferSize];
            _serializationService = serializationService;
            Endianness = endianness;
        }

        public byte[] Buffer
        {
            get =&gt; _buffer;
            set =&gt; _buffer = value;
        }

        internal int Position
        {
            get =&gt; _position;
            private set =&gt; _position = value;
        }

        public void WriteInt(int position, int value)
        {
            EnsureAvailable(BytesExtensions.SizeOfInt);
            _buffer.WriteInt(position, value, Endianness);
        }

        public void WriteIntBigEndian(int value)
        {
            EnsureAvailable(BytesExtensions.SizeOfInt);
            _buffer.WriteInt(_position, value, Endianness.BigEndian);
            _position += BytesExtensions.SizeOfInt;
        }

        public void WriteZeroBytes(int count)
        {
            EnsureAvailable(count);
            for (var i = 0; i &lt; count; i++)
            {
                _buffer.WriteByte(_position, 0);
                _position += BytesExtensions.SizeOfByte;
            }
        }

        public void Clear()
        {
            Position = 0;
            if (_buffer != null &amp;&amp; _buffer.Length &gt; _initialBufferSize * 8)
            {
                _buffer = new byte[_initialBufferSize * 8];
            }
        }

        public void Dispose()
        {
            Position = 0;
            _buffer = null;
        }

        internal void EnsureAvailable(int count)
        {
            if (_buffer != null)
            {
                if (_buffer.Length - Position &gt;= count) return;
                var newCap = Math.Max(_buffer.Length &lt;&lt; 1, _buffer.Length + count);
                var newBuffer = new byte[newCap];
                System.Buffer.BlockCopy(_buffer, 0, newBuffer, 0, Position);
                _buffer = newBuffer;
            }
            else
            {
                _buffer = new byte[count &gt; _initialBufferSize / 2 ? count * 2 : _initialBufferSize];
            }
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[27,9,27,123,0],[29,13,29,52,0],[30,13,30,52,0],[31,13,31,58,0],[32,13,32,37,0],[33,9,33,10,0],[37,20,37,27,0],[38,20,38,35,0],[43,20,43,29,0],[44,28,44,45,0],[49,13,49,56,0],[50,13,50,59,0],[51,9,51,10,0],[55,13,55,56,0],[56,13,56,70,0],[57,13,57,52,0],[58,9,58,10,0],[62,13,62,36,0],[63,18,63,27,0],[63,29,63,38,0],[63,40,63,43,0],[65,17,65,49,0],[66,17,66,57,0],[68,9,68,10,0],[72,13,72,26,0],[73,13,73,76,0],[75,17,75,60,0],[77,9,77,10,0],[81,13,81,26,0],[82,13,82,28,0],[83,9,83,10,0],[87,13,87,33,0],[89,17,89,56,0],[89,57,89,64,0],[90,17,90,84,0],[91,17,91,50,0],[92,17,92,77,0],[93,17,93,37,0],[97,17,97,101,0],[99,9,99,10,0]]);
    </script>
  </body>
</html>