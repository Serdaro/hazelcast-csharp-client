<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>D:\a\hazelcast-csharp-client\hazelcast-csharp-client\src\ExpectedObjects\ExpectedObjects\src\ExpectedObjects\PropertyInfoExtensions.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;
using System.Reflection;

namespace ExpectedObjects
{
    public static class PropertyInfoExtensions
    {
        public static IEnumerable&lt;PropertyInfo&gt; GetVisibleProperties(this Type type, BindingFlags bindingFlags)
        {
            var properties = new List&lt;PropertyInfo&gt;();

            var declaredProperties = type.GetProperties(bindingFlags).Where(t =&gt; t.DeclaringType == type).ToList();

            properties.AddRange(declaredProperties);

            var baseType = type.GetTypeInfo().BaseType;
            if (baseType != null)
            {
                var baseProperties = GetVisibleProperties(baseType, bindingFlags, declaredProperties);

                foreach (var baseProperty in baseProperties)
                {
                    if (properties.All(p =&gt; p.Name != baseProperty.Name))
                    {
                        properties.Add(baseProperty);
                    }
                }
            }

            return properties;
        }

        static IEnumerable&lt;PropertyInfo&gt; GetVisibleProperties(Type type, BindingFlags bindingFlags, IList&lt;PropertyInfo&gt; filterProperties)
        {
            var properties = new List&lt;PropertyInfo&gt;();

            var declaredVisibleProperties = type.GetProperties(bindingFlags).Where(t =&gt; t.DeclaringType == type &amp;&amp;
                                                        !filterProperties.Any(f =&gt; f.Name == t.Name &amp;&amp; t.HasSameIndexParameters(f))).ToList();

            properties.AddRange(declaredVisibleProperties);

            var baseType = type.GetTypeInfo().BaseType;
            if (baseType != null)
            {
                properties.AddRange(GetVisibleProperties(baseType, bindingFlags, declaredVisibleProperties));
            }

            return properties;
        }

        public static bool HasSameIndexParameters(this PropertyInfo propertyInfo1, PropertyInfo propertyInfo2)
        {
            var param1 = propertyInfo1.GetIndexParameters().ToList();
            var param2 = propertyInfo2.GetIndexParameters().ToList();

            if (param1.Count != param2.Count)
                return false;

            for (var i = 0; i &lt; param1.Count; i++)
                if (param1[i] != param2[i])
                    return false;

            return true;
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[12,13,12,55,1],[14,13,14,82,1],[14,82,14,105,1],[14,105,14,116,1],[16,13,16,53,1],[18,13,18,56,1],[19,13,19,34,1],[21,17,21,103,1],[23,26,23,42,1],[23,43,23,45,1],[23,46,23,60,1],[25,21,25,45,1],[25,45,25,72,1],[25,72,25,74,1],[27,25,27,54,1],[32,13,32,31,1],[37,13,37,55,1],[39,13,39,89,1],[39,89,40,84,1],[40,84,40,131,1],[40,131,40,132,1],[40,132,40,143,1],[42,13,42,60,1],[44,13,44,56,1],[45,13,45,34,1],[47,17,47,110,1],[50,13,50,31,1],[55,13,55,70,1],[56,13,56,70,1],[58,13,58,46,1],[59,17,59,30,0],[61,18,61,27,1],[61,29,61,45,1],[61,47,61,50,0],[62,17,62,44,0],[63,21,63,34,0],[65,13,65,25,1]]);
    </script>
  </body>
</html>